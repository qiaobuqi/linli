<view class="container">
  <block wx:if="{{hasUserInfo}}">
    <!-- ç”¨æˆ·èµ„æ–™å¡ç‰‡ -->
    <view class="profile-card">
      <image class="profile-bg" src="https://images.unsplash.com/photo-1557683316-973673baf926?w=800" mode="aspectFill"></image>
      <view class="profile-overlay"></view>
      
      <view class="profile-content">
        <view class="avatar-section">
          <image class="avatar" src="{{userInfo.avatar_url || userInfo.avatarUrl}}" mode="aspectFill"></image>
          <view class="verify-badge" wx:if="{{userInfo.verified}}">
            <text class="verify-icon">âœ“</text>
          </view>
        </view>
        
        <view class="user-info">
          <text class="nickname">{{userInfo.nickname || userInfo.nickName}}</text>
          <view class="level-badge">
            <text class="level-icon">â­</text>
            <text class="level-text">Lv.{{userInfo.level || 1}}</text>
          </view>
        </view>

        <view class="user-bio">{{userInfo.bio || 'è¿™ä¸ªäººå¾ˆæ‡’ï¼Œä»€ä¹ˆéƒ½æ²¡å†™~'}}</view>
      </view>
    </view>

    <!-- ä¿¡ç”¨åˆ†æ•°å¡ç‰‡ -->
    <view class="credit-card">
      <view class="credit-header">
        <view class="credit-title">
          <text class="title-icon">ğŸ†</text>
          <text class="title-text">ä¿¡ç”¨åˆ†</text>
        </view>
        <text class="credit-hint" bindtap="viewCreditDetail">æŸ¥çœ‹è¯¦æƒ… â€º</text>
      </view>
      
      <view class="credit-score">
        <text class="score-number">{{userInfo.creditScore || 100}}</text>
        <text class="score-label">åˆ†</text>
      </view>
      
      <view class="credit-level">
        <text class="level-name">{{creditLevel}}</text>
        <view class="level-bar">
          <view class="level-progress" style="width: {{creditProgress}}%"></view>
        </view>
      </view>
    </view>

    <!-- æ•°æ®ç»Ÿè®¡ -->
    <view class="stats-section">
      <view class="stat-item" bindtap="viewMyTasks" data-type="published">
        <text class="stat-number">{{userInfo.publishCount || 0}}</text>
        <text class="stat-label">å‘å¸ƒçš„</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item" bindtap="viewMyTasks" data-type="claimed">
        <text class="stat-number">{{userInfo.claimCount || 0}}</text>
        <text class="stat-label">æ¥å•çš„</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item" bindtap="viewMyTasks" data-type="completed">
        <text class="stat-number">{{userInfo.completeCount || 0}}</text>
        <text class="stat-label">å·²å®Œæˆ</text>
      </view>
      <view class="stat-divider"></view>
      <view class="stat-item" bindtap="viewCollections">
        <text class="stat-number">{{userInfo.collectCount || 0}}</text>
        <text class="stat-label">æ”¶è—çš„</text>
      </view>
    </view>

    <!-- é’±åŒ…å¡ç‰‡ -->
    <view class="wallet-card">
      <view class="wallet-header">
        <view class="wallet-title">
          <text class="title-icon">ğŸ’°</text>
          <text class="title-text">æˆ‘çš„é’±åŒ…</text>
        </view>
        <text class="wallet-manage" bindtap="manageWallet">ç®¡ç† â€º</text>
      </view>
      
      <view class="balance-info">
        <view class="balance-item">
          <text class="balance-label">å¯ç”¨ä½™é¢</text>
          <text class="balance-amount">Â¥{{userInfo.balance || '0.00'}}</text>
        </view>
        <view class="balance-item">
          <text class="balance-label">å†»ç»“é‡‘é¢</text>
          <text class="balance-frozen">Â¥{{userInfo.frozenBalance || '0.00'}}</text>
        </view>
      </view>
      
      <view class="wallet-actions">
        <view class="wallet-btn" bindtap="recharge">
          <text class="wallet-icon">ğŸ’³</text>
          <text class="wallet-text">å……å€¼</text>
        </view>
        <view class="wallet-btn" bindtap="withdraw">
          <text class="wallet-icon">ğŸ¦</text>
          <text class="wallet-text">æç°</text>
        </view>
        <view class="wallet-btn" bindtap="viewTransactions">
          <text class="wallet-icon">ğŸ“Š</text>
          <text class="wallet-text">æ˜ç»†</text>
        </view>
      </view>
    </view>

    <!-- æˆå°±ç³»ç»Ÿ -->
    <view class="achievement-section">
      <view class="section-header">
        <view class="section-title">
          <text class="title-icon">ğŸ…</text>
          <text class="title-text">æˆ‘çš„æˆå°±</text>
        </view>
        <text class="section-more" bindtap="viewAllAchievements">å…¨éƒ¨ â€º</text>
      </view>
      
      <scroll-view class="achievement-scroll" scroll-x>
        <view class="achievement-item {{item.unlocked ? 'unlocked' : 'locked'}}" wx:for="{{achievements}}" wx:key="id">
          <view class="achievement-icon">{{item.icon}}</view>
          <text class="achievement-name">{{item.name}}</text>
          <text class="achievement-desc">{{item.desc}}</text>
        </view>
      </scroll-view>
    </view>

    <!-- åŠŸèƒ½èœå• -->
    <view class="menu-section">
      <view class="menu-item" bindtap="navigateTo" data-url="/pages/my-tasks/my-tasks">
        <view class="menu-left">
          <text class="menu-icon">ğŸ“‹</text>
          <text class="menu-text">æˆ‘çš„ä»»åŠ¡</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
      
      <view class="menu-item" bindtap="navigateTo" data-url="/pages/my-applications/my-applications">
        <view class="menu-left">
          <text class="menu-icon">âœ‰ï¸</text>
          <text class="menu-text">æˆ‘çš„ç”³è¯·</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
      
      <view class="menu-item" bindtap="navigateTo" data-url="/pages/my-reviews/my-reviews">
        <view class="menu-left">
          <text class="menu-icon">â­</text>
          <text class="menu-text">è¯„ä»·ç®¡ç†</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
      
      <view class="menu-item" bindtap="navigateTo" data-url="/pages/settings/settings">
        <view class="menu-left">
          <text class="menu-icon">âš™ï¸</text>
          <text class="menu-text">è®¾ç½®</text>
        </view>
        <text class="menu-arrow">â€º</text>
      </view>
    </view>

    <!-- ç¤¾åŒºæŒ‡å¼• -->
    <view class="guide-section">
      <view class="guide-item" bindtap="viewRules">
        <text class="guide-icon">ğŸ“œ</text>
        <text class="guide-text">ç¤¾åŒºå…¬çº¦</text>
      </view>
      <view class="guide-item" bindtap="contactService">
        <text class="guide-icon">ğŸ’¬</text>
        <text class="guide-text">è”ç³»å®¢æœ</text>
      </view>
      <view class="guide-item" bindtap="viewHelp">
        <text class="guide-icon">â“</text>
        <text class="guide-text">ä½¿ç”¨å¸®åŠ©</text>
      </view>
    </view>

    <!-- é€€å‡ºç™»å½• -->
    <view class="logout-section">
      <button class="btn-logout" bindtap="handleLogout">é€€å‡ºç™»å½•</button>
    </view>

  </block>

  <!-- æœªç™»å½•çŠ¶æ€ -->
  <block wx:else>
    <view class="login-prompt">
      <text class="prompt-icon">ğŸ‘‹</text>
      <text class="prompt-title">æ¬¢è¿æ¥åˆ°é‚»é‡Œåœˆ</text>
      <text class="prompt-desc">ç™»å½•åï¼Œå¼€å§‹ä½ çš„é‚»é‡Œäº’åŠ©ä¹‹æ—…</text>
      <button class="btn-login" bindtap="handleLogin">
        <text class="login-icon">ğŸ”</text>
        <text class="login-text">å¾®ä¿¡ä¸€é”®ç™»å½•</text>
      </button>
    </view>
  </block>

  <!-- åº•éƒ¨å ä½ -->
  <view class="bottom-space"></view>
</view>
